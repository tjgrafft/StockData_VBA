Sub moderate_test()    'Set for each worksheet    For Each ws In Worksheets            'Set last row        LastRow = ws.Cells(Rows.Count, 1).End(xlUp).Row            ' Set an initial variable for holding the ticker name        Dim Stock_Name As String        Dim Start_Value As Double            ' Set an initial variable for holding the total volume per stock name        Dim Stock_Total As Double        Stock_Total = 0            'Set an initial variable for year change        Dim Percent_Change As Double        Dim Year_Change As Double        Start_Value = ws.Cells(2, 3)                ' Keep track of the location for each stock name in the summary table        Dim Summary_Table_Row As Integer        Summary_Table_Row = 2            ' Loop through all stocks        For i = 2 To LastRow                ' Check if we are still within the same stock name, if not then..            If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then                    ' Set the stock name            Stock_Name = ws.Cells(i, 1).Value                        'Add to the stock total            Stock_Total = Stock_Total + ws.Cells(i, 7).Value                        'Set the opening number            Year_Change = ws.Cells(i, 6).Value - Start_Value                        ' Print the Stock Name in the Summary Table            ws.Range("I" & Summary_Table_Row).Value = Stock_Name                        ' Print the Volume total per stock            ws.Range("L" & Summary_Table_Row).Value = Stock_Total                        ' Print the Year Change            ws.Range("J" & Summary_Table_Row).Value = Year_Change                        	'Percent change           If Start_Value <> 0 Then 		Percent_Change = Year_Change / Start_Value	Else		Percent_Change = ÒNAÓ	End If            	ws.Range("K" & Summary_Table_Row).Value = Percent_Change                        ' Add one to the summary table row            Summary_Table_Row = Summary_Table_Row + 1                        ' Reset the Stock Total            Stock_Total = 0            Start_Value = ws.Cells(i + 1, 3).Value                                   ' If the cell immediately following a row is the same stock...            Else                            'Add to the Stock Total                Stock_Total = Stock_Total + ws.Cells(i, 7).Value                                                       End If                    Next i                    'Print the headers for Table            ws.Cells(1, 9).Value = "Ticker"            ws.Cells(1, 10).Value = "Yearly Change"            ws.Cells(1, 11).Value = "Percent Change"            ws.Cells(1, 12).Value = "Total Stock Volume"                                                Next ws    End Sub